<html lang="en">
<head>
  <title>TroveSpace</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />




  <style>

  #head {
    font-weight: 500;
  }
	  
  .card {
    padding-bottom: 100px;
  }
	  
  .cover {
	border-radius: 5px;
  }
	  
  .material-icons.md-36 { font-size: 36px; }
	  
  .material-icons.md-dark { color: rgba(0, 0, 0, 0.54); }
	  
  .hover {
	cursor: pointer;
	-webkit-user-select: none; /* Safari */        
	-moz-user-select: none; /* Firefox */
	-ms-user-select: none; /* IE10+/Edge */
	user-select: none; /* Standard */
  }
  .unbold {
	font-weight: normal;
  }

  </style>

</head>
<body>

  <div class="container-fluid">
    <div class="row justify-content-center">
      <div class="col-12 col-sm-10 col-lg-8">
        <div class="card card-nav-tabs">
          <h3 class="card-header card-header-primary" id="head">
            {{collectibleName}}
				<a class="float-right" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				  <i class="material-icons md-36 float-right hover">expand_more</i>
				</a>
				<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
				  <p class="dropdown-item text-center unbold hover mb-0" href="" ng-click="voteForDuplicate()">
					Mark as Duplicate
				  </p>
			  </div>
          </h3>

        <!--This is the approve and disapprove part-->
        <div ng-show="pending" class="text-center">
          <h4>Vote for the edit</h4>
          <div class="container-fluid" id="bar">
            <div class="row">
			  <div class="col-6">
				<div class="progress">
                  <!--The width changes the bar length-->
                  <div class="progress-bar bg-success" role="progressbar" ng-style="{width : (voteKeepEdit*20)+'%'}" aria-valuenow="{{voteKeepEdit}}%" aria-valuemin="0" aria-valuemax="5">{{voteKeepEdit}}</div>
                </div>
				<div class="progress">
                  <!--The width changes the bar length-->
                  <div class="progress-bar bg-danger" role="progressbar" ng-style="{width : (voteRevertEdit*20)+'%'}" aria-valuenow="{{voteRevertEdit}}%" aria-valuemin="0" aria-valuemax="5">{{voteRevertEdit}}</div>
                </div>
			  </div>
              <div class="col-6">
                <button ng-click="incrementKeepVotes(collectibleName)" type="button" id="edit" class="btn btn-success">Approve</button>
		  		<button ng-click="incrementRevertVotes(collectibleName)" type="button" id="edit" class="btn btn-danger">Disapprove</button>
              </div>
            </div>
          </div>
			<hr />
        </div>
        
			
          <div class="card-body">
			<div class="form-group row">
			  <div class="col-6">
				<label for="exampleInput1">Current Image</label>
			    <img width="100%" class="img-responsive cover" ng-src="{{image}}">
			  </div>
			  <div ng-show="pendingimage" class="col-6">
				<label for="exampleInput1">Pending Image</label>
			    <img width="100%" class="img-responsive cover" ng-src="{{pendingimage}}">
			  </div>
		    </div>
            <div class="form-group">
             <label for="exampleInput1">Title</label>
             <input ng-model="collectibleName" class="form-control cover" id="collectibleName" disabled>
           </div>
           <div class="form-group">
            <label for="exampleFormControlTextarea1">Description</label>
            <textarea ng-model="collectible.description" class="form-control" id="collectibleDescription" rows="3"></textarea>
			<textarea ng-show="collectible.pendingdescription" ng-model="collectible.pendingdescription" class="form-control" id="pendingCollectibleDescription" rows="3" disabled></textarea>
          </div>
			  
		  <div ng-repeat="(key, value) in collectible" ng-if="key!='description' && key!='category' && key!='users' && key!='votes' && key!='name' && !key.includes('pending') && !key.includes('duplicate') && key!='lastEditedBy' && key!='collectUsers' && key!='collectCount' && !key.includes('wishlist') && key!='comments'" class="form-group">
             <label for="exampleInput1">{{key}}</label>
             <input ng-model="collectible[key]" class="form-control">
			 <input ng-show="collectible['pending'+key]" ng-model="collectible['pending'+key]" class="form-control" disabled>
          </div>
			  
		  <div ng-repeat="(key, value) in collectible" ng-if="key!='description' && key!='category' && key!='users' && key!='votes' && key!='name' && !key.includes('pending') && !key.includes('duplicate') && key=='lastEditedBy' && key!='collectUsers' && key!='collectCount' && !key.includes('wishlist') && key!='comments'" class="form-group">
             <label for="exampleInput1">Last Edited By</label>
             <input ng-model="collectible[key]" class="form-control" disabled>
			 <input ng-show="collectible['pending'+key]" ng-model="collectible['pending'+key]" class="form-control" disabled>
          </div>
			  
		  <div ng-show="collectible.collectCount!=null" class="form-group">
			<label for="exampleInput1">Added to Collection <i ng-show="dateAddedToCollection" style="vertical-align: bottom" class="material-icons">check</i> {{dateAddedToCollection | amTimeAgo}}</label>
				<div ng-hide="collectible.collectCount==0" class="input-group">
					 <input ng-show="collectible.collectCount==1" value="{{collectible.collectCount}} Person" class="form-control" disabled>
					 <input ng-show="collectible.collectCount>1 || collectible.collectCount==0" value="{{collectible.collectCount}} People" class="form-control" disabled>
					 <span class="input-group-btn">
				   		<button data-toggle="modal" data-target="#viewUserListModal" type="button" class="btn btn-primary">View All</button>
				     </span>
				</div>
			  <div ng-show="collectible.collectCount==0">
			    <input ng-show="collectible.collectCount==1" value="{{collectible.collectCount}} Person" class="form-control" disabled>
				<input ng-show="collectible.collectCount>1 || collectible.collectCount==0" value="{{collectible.collectCount}} People" class="form-control" disabled>
			  </div>
		  </div>
			  
		  <div ng-show="collectible.wishlistCount!=null" class="form-group">
			<label for="exampleInput1">Added to Wishlist <i ng-show="dateAddedToWishlist" style="vertical-align: bottom" class="material-icons">check</i> {{dateAddedToWishlist | amTimeAgo}}</label>
				<div ng-hide="collectible.wishlistCount==0" class="input-group">
					 <input ng-show="collectible.wishlistCount==1" value="{{collectible.wishlistCount}} Person" class="form-control" disabled>
					 <input ng-show="collectible.wishlistCount>1 || collectible.wishlistCount==0" value="{{collectible.wishlistCount}} People" class="form-control" disabled>
					 <span class="input-group-btn">
				   		<button data-toggle="modal" data-target="#viewWishlistModal" type="button" class="btn btn-primary">View All</button>
				     </span>
				</div>
			  <div ng-show="collectible.wishlistCount==0">
			    <input ng-show="collectible.wishlistCount==1" value="{{collectible.wishlistCount}} Person" class="form-control" disabled>
				<input ng-show="collectible.wishlistCount>1 || collectible.wishlistCount==0" value="{{collectible.wishlistCount}} People" class="form-control" disabled>
			  </div>
		  </div>
			  
           <div ng-show="dateAddedToCollection" class="form-group">
			   <label for="exampleInput1">Count</label>
               <div class="input-group">
			   	   <input ng-model="multipleCount" class="form-control" id="multipleCount" value="{{multipleCount}}">
				   <span class="input-group-btn">
				   		<button ng-click="setMultipleCount(collectibleName, multipleCount)" type="button" class="btn btn-success">Save</button>
				   </span>
			   </div>
           </div>
		   <div ng-hide="pending" class="form-group">
			   <label for="exampleInput1">Upload Image:</label>
			   <input id="collectibleImage" ng-model="collectibleImage" type="file" accept="image/*">
		   </div>
       </div>
		
       <div class="text-center">
		<button ng-click="goBack()" type="button" class="btn btn-danger">Back</button>
		<button ng-click="editCollectible(collectibleName)" type="button" class="btn btn-warning">Submit Edit</button>
      </div>
    </div>
    <div class="card card-nav-tabs">
          <h3 class="card-header card-header-primary" id="head">
            Comments
          </h3>
		  <div class="card-body">
			<div class="form-group row">
			  <div class="col-12">
				  	<label for="exampleFormControlTextarea1">Enter Your Comment</label>
            		<textarea ng-model="comment" class="form-control" id="comment" rows="3"></textarea>
				</div>
			  </div>
			  <div class="form-group row">
				  <div class="col-12">
			  	<button ng-click="sendComment(comment)" type="button" class="btn btn-primary">Submit</button>
				  </div>
			  </div>
			  <div ng-repeat="comment in comments" class="col-12">
			  		<div class="row">
						<i class="material-icons md-dark" style="vertical-align: bottom">person</i> {{comment.user}} - 
						{{comment.dateAdded | amTimeAgo}}
					</div>
					<div class="row">
						<textarea ng-model="comment.text" class="form-control" rows="3" disabled></textarea>
						<div style="text-align:right; display:block; width:100%">
							<i ng-show="comment.upvoteUsers[currentUser.uid]==true" class="material-icons hover" style="vertical-align: bottom; color:green" ng-click="upvoteComment(comment.key)">thumb_up</i><i ng-hide="comment.upvoteUsers[currentUser.uid]==true" class="material-icons md-dark hover" style="vertical-align: bottom" ng-click="upvoteComment(comment.key)">thumb_up</i> {{comment.upvotes}} <i ng-show="comment.upvoteUsers[currentUser.uid]==false" ng-click="downvoteComment(comment.key)" class="material-icons hover" style="vertical-align: bottom; color:red">thumb_down</i><i ng-hide="comment.upvoteUsers[currentUser.uid]==false" ng-click="downvoteComment(comment.key)" class="material-icons md-dark hover" style="vertical-align: bottom">thumb_down</i> {{comment.downvotes}} <i class="material-icons md-dark hover" style="vertical-align: bottom" ng-click="textareashow[comment.key] = !textareashow[comment.key]">chat</i> Reply<span ng-show="currentUser.displayName==comment.user"><i class="material-icons md-dark hover" ng-click="deleteComment(comment.key)" style="vertical-align: bottom">delete</i>Delete</span>
						</div>
						<div style="margin-left: 100px;" ng-show="textareashow[comment.key]" class="input-group form-group">
							<input ng-model="reply[comment.key]" class="form-control" placeholder="Enter Reply">
							<span class="input-group-btn">
								<button ng-click="sendReply(reply[comment.key], comment.key)" type="button" class="btn btn-primary"><i class="material-icons" style="vertical-align: bottom">reply</i></button>
							</span>
						</div>
						<div ng-repeat="replyText in comment.replies" style="margin-left: 100px; text-align:left; display:block; width:100%" class="form-group">
							<i class="material-icons md-dark" style="vertical-align: bottom">person</i>{{replyText.user}} - 
							{{replyText.dateAdded | amTimeAgo}}<i class="material-icons md-dark hover" style="vertical-align: bottom" ng-show="currentUser.displayName==replyText.user" ng-click="deleteReply(replyText.key, comment.key)">close</i>
							<input ng-model="replyText.text" class="form-control" disabled>
						</div>
					</div>
			  </div>
		</div>
	</div>
  </div>

</div>
</div>
	
	<!-- Modal -->
	<div class="modal fade" id="duplicateCollectibleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h3 class="modal-title" id="modalLabel">Duplicate Collectible</h3>
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
			  <span aria-hidden="true">&times;</span>
			</button>
		  </div>
		  <div class="modal-body">
			<div class="row">
			  <div ng-hide="collectible.duplicateName" name="message" class="col col-lg-9">
				Please select the duplicate collectible: 
				<select ng-model="duplicateCollectibleName" class="form-control">
					<option ng-repeat="(key, value) in collectibles" ng-if="key!=collectibleName">{{key}}</option>
				</select>
			  </div>
			  <div ng-show="collectible.duplicateName" ng-if="collectible.duplicateYes==1" name="message" class="col col-lg-9">
				{{collectible.duplicateYes}} user marked this as a duplicate of {{collectible.duplicateName}}. Do you agree?
			  </div>
			  <div ng-show="collectible.duplicateName" ng-if="collectible.duplicateYes>1" name="message" class="col col-lg-9">
				{{collectible.duplicateYes}} users marked this as a duplicate of {{collectible.duplicateName}}. Do you agree?
			  </div>
			</div>
		  </div>
		  <div class="modal-footer">
			<button ng-show="collectible.duplicateName" ng-click="voteDuplicateCollectible(collectible.duplicateName)" name="confirm" type="button" class="btn btn-success" data-dismiss="modal">Yes</button>
			<button ng-show="collectible.duplicateName" ng-click="voteNotDuplicateCollectible(duplicateCollectibleName)" type="button" class="btn btn-danger" data-dismiss="modal" aria-label="Close">No</button>
			<button ng-hide="collectible.duplicateName" ng-click="voteDuplicateCollectible(duplicateCollectibleName)" name="confirm" type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
		  </div>
		</div>
	  </div>
	</div>
	
	<!-- Modal -->
	<div class="modal fade" id="viewUserListModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h3 class="modal-title" id="modalLabel">Users With Collectible</h3>
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
			  <span aria-hidden="true">&times;</span>
			</button>
		  </div>
		  <div class="modal-body">
			<div class="list-group">
			  <a href="" ng-click="viewCollectUser(key)" ng-repeat="(key, value) in collectUsers" name="message" class="list-group-item">
				<i style="vertical-align: bottom" class="material-icons hover">person</i> {{value}}
			  </a>
			</div>
		  </div>
		  <div class="modal-footer">
			<button name="confirm" type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
		  </div>
		</div>
	  </div>
	</div>
	
	<!-- Modal -->
	<div class="modal fade" id="viewWishlistModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h3 class="modal-title" id="modalLabel">Users With Collectible</h3>
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
			  <span aria-hidden="true">&times;</span>
			</button>
		  </div>
		  <div class="modal-body">
			<div class="list-group">
			  <a href="" ng-click="viewWishlistUser(key)" ng-repeat="(key, value) in wishlistUsers" name="message" class="list-group-item">
				<i style="vertical-align: bottom" class="material-icons hover">person</i> {{value}}
			  </a>
			</div>
		  </div>
		  <div class="modal-footer">
			<button name="confirm" type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
		  </div>
		</div>
	  </div>
	</div>

</body>
</html>
